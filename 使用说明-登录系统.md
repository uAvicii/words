# 登录系统使用说明

## 功能概述

现在背单词应用已经支持账号密码登录，每个用户的数据都是独立保存的。

## 新增功能

1. **用户登录/注册**
   - 访问应用时会自动跳转到登录页
   - 首次使用的用户名会自动注册
   - 已注册用户需要输入正确密码

2. **数据隔离**
   - 每个用户的单词数据独立保存
   - 登录后自动加载该用户的历史数据
   - 所有操作（添加、删除、分类、复习）都会实时同步到后端

3. **用户管理**
   - 导航栏显示当前登录用户名
   - 支持登出功能
   - 登出后会清除本地缓存

## 使用步骤

### 1. 启动后端服务器

打开第一个终端窗口：

```bash
npm run server
```

或开发模式（支持热重载）：

```bash
npm run server:dev
```

服务器会运行在 `http://localhost:3000`

### 2. 启动前端应用

打开第二个终端窗口：

```bash
npm run dev
```

前端应用会运行在 `http://localhost:5173`

### 3. 登录使用

1. 访问 `http://localhost:5173`
2. 输入用户名和密码
3. 点击"登录/注册"按钮
4. 首次登录会自动创建账号
5. 登录成功后跳转到首页

## 技术实现

### 后端 (Node.js + Express)

- **位置**: `server/server.js`
- **数据存储**: JSON 文件 (`server/data/users.json`)
- **API 接口**:
  - `POST /api/login` - 登录/注册
  - `GET /api/words/:username` - 获取用户单词数据
  - `POST /api/words/:username` - 保存用户单词数据

### 前端修改

1. **新增用户 Store** (`src/stores/userStore.js`)
   - 管理登录状态
   - 处理登录/登出逻辑

2. **修改单词 Store** (`src/stores/wordStore.js`)
   - 添加后端同步功能
   - 所有数据操作都会自动保存到后端

3. **新增登录页面** (`src/views/Login.vue`)
   - 美观的登录界面
   - 表单验证和错误提示

4. **路由守卫** (`src/router/index.js`)
   - 未登录用户自动跳转到登录页
   - 已登录用户不能访问登录页

## 数据结构

### 用户数据格式 (users.json)

```json
{
  "username1": {
    "password": "password1",
    "words": [...],
    "createdAt": "2025-10-09T...",
    "lastUpdated": "2025-10-09T..."
  },
  "username2": {
    "password": "password2",
    "words": [...],
    "createdAt": "2025-10-09T...",
    "lastUpdated": "2025-10-09T..."
  }
}
```

## 注意事项

1. **密码安全**: 当前版本密码以明文存储，仅适合学习和测试使用
2. **数据备份**: 用户数据保存在 `server/data/users.json`，建议定期备份
3. **同时运行**: 必须同时启动后端和前端才能正常使用
4. **端口占用**: 确保 3000 和 5173 端口未被占用

## 最小改动说明

本次改动遵循最小改动原则：

1. 保留了原有的 localStorage 缓存机制（离线也能使用）
2. 在原有数据操作函数中添加了后端同步调用
3. 使用简单的 JSON 文件存储，无需配置数据库
4. 路由和页面结构改动最小
5. 原有功能完全保留，只是添加了用户隔离

## 升级建议（可选）

如需生产环境使用，建议：

1. 使用真实数据库（如 MongoDB、PostgreSQL）
2. 添加密码加密（如 bcrypt）
3. 使用 JWT 进行身份验证
4. 添加更完善的错误处理
5. 支持密码重置等高级功能

